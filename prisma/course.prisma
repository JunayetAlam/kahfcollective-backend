model Course {
    id String @id @default(auto()) @map("_id") @db.ObjectId

    title        String
    description  String
    tierId       String       @db.ObjectId
    status       CourseStatus @default(ACTIVE)
    language     String
    isDeleted    Boolean      @default(false)
    instructorId String       @db.ObjectId

    forums         Forum[]
    courseContents CourseContents[]
    coursesEnroll  CourseEnroll[]
    tier           Tier             @relation(fields: [tierId], references: [id])
    instructor     User             @relation(fields: [instructorId], references: [id])

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@map("courses")
}

model CourseEnroll {
    id String @id @default(auto()) @map("_id") @db.ObjectId

    userId     String  @db.ObjectId
    courseId   String  @db.ObjectId
    isEnrolled Boolean @default(true)

    user   User   @relation(fields: [userId], references: [id])
    course Course @relation(fields: [courseId], references: [id])

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@unique([userId, courseId])
    @@map("course_enrolls")
}

model CourseContents {
    id String @id @default(auto()) @map("_id") @db.ObjectId

    type         CourseContentTypeEnum
    title        String
    description  String
    videoUrl     String?
    quizzes      Quiz[]
    status       ContentStatusEnum
    isDeleted    Boolean               @default(false)
    index        Int
    courseId     String                @db.ObjectId
    instructorId String                @db.ObjectId

    course     Course @relation(fields: [courseId], references: [id])
    instructor User   @relation(fields: [instructorId], references: [id])

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@map("course_contents")
}

model Quiz {
    id String @id @default(auto()) @map("_id") @db.ObjectId

    courseContentId String      @db.ObjectId
    instructorId    String      @db.ObjectId
    question        String
    options         Options
    rightAnswer     RightAnswer
    isDeleted       Boolean     @default(false)
    index           Int

    courseContent CourseContents @relation(fields: [courseContentId], references: [id])
    instructor    User           @relation(fields: [instructorId], references: [id])

    createdAt   DateTime      @default(now())
    updatedAt   DateTime      @updatedAt
    quizAnswers QuizAnswers[]

    @@map("quizzes")
}

model QuizAnswers {
    id String @id @default(auto()) @map("_id") @db.ObjectId

    quizId      String       @db.ObjectId
    userId      String       @db.ObjectId
    answer      RightAnswer
    rightAnswer RightAnswer?
    isRight     Boolean?
    isDeleted   Boolean      @default(false)
    isLocked    Boolean      @default(false)

    quiz Quiz @relation(fields: [quizId], references: [id])
    user User @relation(fields: [userId], references: [id])

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@unique([quizId, userId])
    @@map("quiz_answers")
}

enum CourseContentTypeEnum {
    VIDEO
    QUIZ
}

enum ContentStatusEnum {
    PUBLISHED
    DRAFT
}

type Options {
    A String
    B String
    C String
    D String
}

enum RightAnswer {
    A
    B
    C
    D
}

enum CourseStatus {
    DRAFT
    ACTIVE
    HIDDEN
}
